# Текстовый отчет по автоматизации установки ПО и созданию образов системы под ОС Windows

## 1. Введение
Целью данной работы является исследование и практическая реализация методов автоматизации процессов установки/настройки прикладного программного обеспечения и создания резервных копий (образов) операционной системы Windows.
Автоматизация этих задач позволяет:
Экономить время: Установка десятков программ вручную занимает часы. Скрипт выполняет это без вмешательства пользователя.
Обеспечивать повторяемость и единообразие: Настройка идентичного рабочего окружения на нескольких машинах (например, в учебном классе).
Быстро восстанавливать систему: Образ системы позволяет вернуть её в рабочее состояние за минуты после сбоя.

## 2. Исследование способов и технологий
2.1. Автоматизация установки ПО
Для автоматической установки ПО в Windows существует несколько подходов:
Пакетные файлы (.bat) и скрипты PowerShell (.ps1): Базовый метод, как указано в задании. Использует встроенные возможности ОС для запуска установщиков с тихими ключами (/S, /VERYSILENT, -q). Требует ручного скачивания дистрибутивов или использования curl/wget.
Менеджеры пакетов для Windows:
Chocolatey: Наиболее популярный менеджер пакетов. Имеет огромный репозиторий программ. Установка сводится к команде choco install googlechrome -y.
WinGet: Современный менеджер пакетов от Microsoft, встроенный в Windows 10 (через App Get) и 11. Устанавливается отдельно или через магазин Microsoft. Команда: winget install Google.Chrome.
Средства развертывания (MDT, SCCM): Корпоративные решения для развертывания ОС и ПО на большом парке компьютеров. Для наших целей являются избыточными.
Выбор для реализации: Комбинированный подход с использованием Chocolatey. Это идеальный баланс между простотой и мощностью. Для программ, которых нет в репозитории Chocolatey, будем использовать прямое скачивание и установку через PowerShell.

2.2. Создание резервной копии (образа) системы
Для создания образов системы также есть несколько вариантов:
Встроенные средства Windows:
"История файлов": Не создает полный образ системы, только резервные копии файлов в личных папках.
"Резервное копирование и восстановление" (Windows 7): Позволяет создать образ всей системы на разделе. Интегрировано в ОС, но морально устарело и может быть медленным.

Стороннее ПО:
Macrium Reflect Free: Очень популярное, надежное и бесплатное решение с отличным балансом возможностей и простоты. Поддерживает инкрементальные бэкапы, планировщик и аварийный загрузочный носитель.
AOMEI Backupper, Clonezilla: Другие достойные альтернативы.
Командная строка (wbAdmin): Мощный инструмент для профессионалов, позволяет создавать образы через скрипты. Синтаксис сложнее, чем у графических утилит.
Выбор для реализации: Macrium Reflect Free как наиболее удобный и эффективный инструмент для большинства пользователей. Его установку и запуск создания образа можно также автоматизировать с помощью скрипта.

## 3. Практическая реализация
3.1. Скрипт автоматизации установки ПО
Был создан скрипт на PowerShell (install-software.ps1), так как он более мощный и современный по сравнению с .bat.
Листинг кода и комментарии:

```powershell

# install-software.ps1
# Скрипт автоматической установки ПО для Windows
# ТРЕБУЕТ ЗАПУСКА ОТ ИМЕНИ АДМИНИСТРАТОРА (Run as Administrator)!

# Отключает запрос на подтверждение для Chocolatey
Set-ExecutionPolicy Bypass -Scope Process -Force

# 1. УСТАНОВКА И НАСТРОЙКА CHOCOLATEY
Write-Host "Устанавливаем Chocolatey..." -ForegroundColor Green
[System.Net.ServicePointManager]::SecurityProtocol = [System.Net.ServicePointManager]::SecurityProtocol -bor 3072
iex ((New-Object System.Net.WebClient).DownloadString('https://community.chocolatey.org/install.ps1'))
refreshenv

# 2. УСТАНОВКА ПО ИЗ РЕПОЗИТОРИЯ CHOCOLATEY
# Список программ, которые можно установить через choco
$chocoPackages = @(
    "vscode",
    "docker-desktop",
    "pycharm-community",
    "git",
    "github-desktop",
    "maxima",
    "gimp",
    "python",
    "msys2",
    "miktex",
    "texstudio",
    "anaconda3",
    "far",
    "sumatrapdf",
    "googlechrome",
    "firefox",
    "7zip",
    "vlc" # Добавим для примеря еще и VLC
)

Write-Host "Начинаем установку ПО через Chocolatey..." -ForegroundColor Green
foreach ($package in $chocoPackages) {
    Write-Host "Устанавливаем $package..." -ForegroundColor Yellow
    choco install $package -y --no-progress
}

# 3. УСТАНОВКА ПО, КОТОРОГО НЕТ В CHOCOLATEY (через прямые ссылки)
Write-Host "Устанавливаем ПО не из Chocolatey..." -ForegroundColor Green

# 3.1. Установка Julia
Write-Host "Скачиваем и устанавливаем Julia..." -ForegroundColor Yellow
$juliaUrl = "https://julialang-s3.julialang.org/bin/winnt/x64/1.10/julia-1.10.3-win64.exe"
$juliaInstaller = "$env:TEMP\julia-installer.exe"
Invoke-WebRequest -Uri $juliaUrl -OutFile $juliaInstaller
Start-Process -FilePath $juliaInstaller -Args "/S" -Wait -Verb RunAs

# 3.2. Установка Rust (используем официальный скрипт)
Write-Host "Устанавливаем Rust..." -ForegroundColor Yellow
Invoke-WebRequest -Uri "https://win.rustup.rs/x86_64" -OutFile "$env:TEMP\rustup-init.exe"
Start-Process -FilePath "$env:TEMP\rustup-init.exe" -Args "-y" -Wait

# 3.3. Установка Zettlr
Write-Host "Скачиваем и устанавливаем Zettlr..." -ForegroundColor Yellow
$zettlrUrl = "https://github.com/Zettlr/Zettlr/releases/download/v3.0.4/Zettlr-Windows-x64-3.0.4.exe"
$zettlrInstaller = "$env:TEMP\zettlr-installer.exe"
Invoke-WebRequest -Uri $zettlrUrl -OutFile $zettlrInstaller
Start-Process -FilePath $zettlrInstaller -Args "/S" -Wait -Verb RunAs

# 3.4. Установка Flameshot
Write-Host "Скачиваем и устанавливаем Flameshot..." -ForegroundColor Yellow
$flameshotUrl = "https://github.com/flameshot-org/flameshot/releases/download/v13.1.1/flameshot-13.1.1-win64-installer.exe"
$flameshotInstaller = "$env:TEMP\flameshot-installer.exe"
Invoke-WebRequest -Uri $flameshotUrl -OutFile $flameshotInstaller
Start-Process -FilePath $flameshotInstaller -Args "/S" -Wait -Verb RunAs

# 3.5. Установка WSL2 и Ubuntu 22.04
Write-Host "Устанавливаем WSL2 и Ubuntu 22.04..." -ForegroundColor Yellow
wsl --install -d Ubuntu-22.04 --no-distribution-code
# Ответить 'y' на запрос перезагрузки нужно будет после завершения всего скрипта

# 4. ПОСЛЕУСТАНОВОЧНАЯ НАСТРОЙКА VS CODE
Write-Host "Настраиваем VS Code, устанавливаем расширения..." -ForegroundColor Green
$vscodeExtensions = @(
    "ms-python.python",
    "ms-vscode.cpptools",
    "ms-azuretools.vscode-docker",
    "ms-vscode.PowerShell",
    "yzhang.markdown-all-in-one",
    "bungcip.better-toml",
    "bung87.rust-analyzer",
    "julialang.language-julia"
)
foreach ($extension in $vscodeExtensions) {
    Write-Host "Устанавливаем расширение $extension..." -ForegroundColor Yellow
    code --install-extension $extension --force
}
```
# 5. УСТАНОВКА ПО для 313 АУДИТОРИИ (если нужно)
# Файлы предполагается скачать заранее и положить рядом со скриптом в папку 'software_313'
Write-Host "Проверяем наличие ПО для 313 аудитории..." -ForegroundColor Green
$software313Path = ".\software_313"
if (Test-Path $software313Path) {
    Write-Host "Найдены дистрибутивы для 313 аудитории. Начинаем установку..." -ForegroundColor Yellow

    # Ramus Educational
    $ramusInstaller = Get-ChildItem -Path $software313Path -Filter "*ramus*" | Select-Object -First 1
    if ($ramusInstaller) {
        Write-Host "Устанавливаем Ramus Educational..." -ForegroundColor Yellow
        Start-Process -FilePath $ramusInstaller.FullName -Args "/S" -Wait -Verb RunAs
    }

    # ARIS Express
    $arisInstaller = Get-ChildItem -Path $software313Path -Filter "*aris*" | Select-Object -First 1
    if ($arisInstaller) {
        Write-Host "Устанавливаем ARIS Express..." -ForegroundColor Yellow
        Start-Process -FilePath $arisInstaller.FullName -Args "/S" -Wait -Verb RunAs
    }

    # Archi
    $archiInstaller = Get-ChildItem -Path $software313Path -Filter "*archi*" | Select-Object -First 1
    if ($archiInstaller) {
        Write-Host "Устанавливаем Archi..." -ForegroundColor Yellow
        # Archi - это portable zip, его нужно распаковать в Program Files
        $archiDest = "C:\Program Files\Archi"
        Expand-Archive -Path $archiInstaller.FullName -DestinationPath $archiDest -Force
    }
}

Write-Host "Установка завершена! Система требует перезагрузки для активации WSL2." -ForegroundColor Green
Write-Host "Пожалуйста, перезагрузите компьютер." -ForegroundColor Green
Как выполнить:
Сохраните код в файл с расширением .ps1 (например, install-software.ps1).

Важно: Запустите PowerShell от имени Администратора.
Перейдите в папку со скриптом: cd C:\path\to\script\.
Разрешите выполнение скриптов (если нужно): Set-ExecutionPolicy RemoteSigned -Scope CurrentUser.
Запустите скрипт: .\install-software.ps1.

3.2. Создание образа системы с помощью Macrium Reflect
Автоматизировать полный процесс создания бэкапа сложнее, но можно упростить задачу.
Установите Macrium Reflect Free.
Вручную создайте резервную копию (образ) вашей чистой, настроенной системы:
Запустите Macrium Reflect.
Нажмите "Backup" -> "Create an image of the partition(s) required to backup and restore Windows".
Выберите destination (внешний HDD, сетевой диск).
Нажмите "Finish", затем "OK" для начала создания образа.
Создайте Аварийный носитель (Rescue Media): Это позволит восстановить систему даже если она не загружается. Делается через вкладку "Other Tasks".

(Опционально) Автоматизация через скрипт:
Macrium Reflect имеет командную строку (reflect.exe), которую можно использовать для автоматизации. Пример команды для создания образа:
reflect.exe -e -d C: -f "D:\MyBackups\SystemImage.mrimg" -r full
Однако настройка таких команд требует глубокого изучения документации.

Рекомендуемый подход: Создать эталонный образ вручную один раз. Затем, при необходимости развертывания на multiple machines, использовать этот образ. Восстановление из образа через загрузочный носитель Macrium Reflect занимает 10-15 минут.

4. Заключение
В ходе работы были исследованы и успешно применены на практике современные методы автоматизации для ОС Windows.
Для установки ПО: Наилучшим решением оказалось использование менеджера пакетов Chocolatey в связке со скриптом на PowerShell для обработки исключений. Этот подход мощный, настраиваемый и требует минимальных усилий для поддержки.
Для создания бэкапа: Наиболее удобным и надежным инструментом признана программа Macrium Reflect Free, которая предоставляет как графический интерфейс для разовых операций, так и возможности для автоматизации через командную строку.

Данные решения позволяют быстро развертывать сложные рабочие окружения, что критически важно в образовательных (аудитории) и корпоративных сценариях использования.
